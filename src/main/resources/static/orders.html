<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8" />
    <title>我的订单</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <style>
        body { font-family: -apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Helvetica,Arial; margin: 24px; }
        h1 { font-size: 20px; margin-bottom: 12px; }
        table { width: 100%; border-collapse: collapse; }
        th, td { padding: 10px 8px; border-bottom: 1px solid #eee; text-align: left; }
        th { background: #fafafa; }
        .btn { padding: 8px 12px; border: 1px solid #1677ff; background: #1677ff; color: #fff; border-radius: 4px; cursor: pointer; }
        .btn.link { background: #fff; color: #1677ff; }
    </style>
</head>
<body>
<div style="margin-bottom:12px;">
    <a class="btn link" href="/index.html">← 返回首页</a>
</div>

<h1>我的订单</h1>
<div id="root">加载中...</div>

<script>
    async function api(path, options={}) {
        const res = await fetch(path, { credentials:'include', ...options });
        if (!res.ok) throw new Error(await res.text() || res.status);
        return res.json();
    }
    (async () => {
        try {
            const rows = await api('/api/orders/my');
            if (!rows.length) {
                document.getElementById('root').textContent = '暂无订单';
                return;
            }
            const table = document.createElement('table');
            table.innerHTML = '<thead><tr><th>订单号</th><th>下单时间</th><th>状态</th><th>总金额</th><th>地址</th></tr></thead>';
            const tb = document.createElement('tbody');
            rows.forEach(o => {
                const tr = document.createElement('tr');
                tr.innerHTML = `
            <td>${o.id}</td>
            <td>${new Date(o.orderTime).toLocaleString()}</td>
            <td>${o.status}</td>
            <td>${o.totalAmount}</td>
            <td>${o.address || ''}</td>
          `;
                tb.appendChild(tr);
            });
            table.appendChild(tb);
            const root = document.getElementById('root');
            root.innerHTML = '';
            root.appendChild(table);
        } catch(e) {
            document.getElementById('root').textContent = '加载失败：' + e.message;
        }
    })();
</script>
</body>
</html>
